import{c as _,o as w,a as n,H as ne,I as V,r as h,J as M,E as T,K as le,L as oe,F as Z,M as L,d as E,l as P,N as q,B as se,k as ae,e as H,z as ie,t as $,y as D,b as re,w as R,q as I,G as ue,v as y,A as de,O as ce,x as S,P as F}from"./index-Cwj_Fd2k.js";function pe(e,a){return w(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}var K;let fe=Symbol("headlessui.useid"),ge=0;const J=(K=ne)!=null?K:function(){return V(fe,()=>`${++ge}`)()};function k(e){var a;if(e==null||e.value==null)return null;let o=(a=e.value.$el)!=null?a:e.value;return o instanceof Node?o:null}function U(e,a,...o){if(e in a){let t=a[e];return typeof t=="function"?t(...o):t}let i=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(a).map(t=>`"${t}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,U),i}function W(e,a){if(e)return e;let o=a??"button";if(typeof o=="string"&&o.toLowerCase()==="button")return"button"}function me(e,a){let o=h(W(e.value.type,e.value.as));return M(()=>{o.value=W(e.value.type,e.value.as)}),T(()=>{var i;o.value||k(a)&&k(a)instanceof HTMLButtonElement&&!((i=k(a))!=null&&i.hasAttribute("type"))&&(o.value="button")}),o}var B=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(B||{}),be=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(be||{});function N({visible:e=!0,features:a=0,ourProps:o,theirProps:i,...t}){var f;let u=Q(i,o),d=Object.assign(t,{props:u});if(e||a&2&&u.static)return A(d);if(a&1){let m=(f=u.unmount)==null||f?0:1;return U(m,{0(){return null},1(){return A({...t,props:{...u,hidden:!0,style:{display:"none"}}})}})}return A(d)}function A({props:e,attrs:a,slots:o,slot:i,name:t}){var f,u;let{as:d,...m}=xe(e,["unmount","static"]),g=(f=o.default)==null?void 0:f.call(o,i),v={};if(i){let x=!1,p=[];for(let[c,l]of Object.entries(i))typeof l=="boolean"&&(x=!0),l===!0&&p.push(c);x&&(v["data-headlessui-state"]=p.join(" "))}if(d==="template"){if(g=G(g??[]),Object.keys(m).length>0||Object.keys(a).length>0){let[x,...p]=g??[];if(!ve(x)||p.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${t} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(m).concat(Object.keys(a)).map(s=>s.trim()).filter((s,b,r)=>r.indexOf(s)===b).sort((s,b)=>s.localeCompare(b)).map(s=>`  - ${s}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(s=>`  - ${s}`).join(`
`)].join(`
`));let c=Q((u=x.props)!=null?u:{},m,v),l=le(x,c,!0);for(let s in c)s.startsWith("on")&&(l.props||(l.props={}),l.props[s]=c[s]);return l}return Array.isArray(g)&&g.length===1?g[0]:g}return oe(d,Object.assign({},m,v),{default:()=>g})}function G(e){return e.flatMap(a=>a.type===Z?G(a.children):[a])}function Q(...e){if(e.length===0)return{};if(e.length===1)return e[0];let a={},o={};for(let i of e)for(let t in i)t.startsWith("on")&&typeof i[t]=="function"?(o[t]!=null||(o[t]=[]),o[t].push(i[t])):a[t]=i[t];if(a.disabled||a["aria-disabled"])return Object.assign(a,Object.fromEntries(Object.keys(o).map(i=>[i,void 0])));for(let i in o)Object.assign(a,{[i](t,...f){let u=o[i];for(let d of u){if(t instanceof Event&&t.defaultPrevented)return;d(t,...f)}}});return a}function xe(e,a=[]){let o=Object.assign({},e);for(let i of a)i in o&&delete o[i];return o}function ve(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let Y=Symbol("Context");var C=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(C||{});function ye(){return V(Y,null)}function he(e){L(Y,e)}var O=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(O||{}),ke=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ke||{});let X=Symbol("DisclosureContext");function z(e){let a=V(X,null);if(a===null){let o=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,z),o}return a}let ee=Symbol("DisclosurePanelContext");function we(){return V(ee,null)}let Se=E({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:a,attrs:o}){let i=h(e.defaultOpen?0:1),t=h(null),f=h(null),u={buttonId:h(`headlessui-disclosure-button-${J()}`),panelId:h(`headlessui-disclosure-panel-${J()}`),disclosureState:i,panel:t,button:f,toggleDisclosure(){i.value=U(i.value,{0:1,1:0})},closeDisclosure(){i.value!==1&&(i.value=1)},close(d){u.closeDisclosure();let m=d?d instanceof HTMLElement?d:d.value instanceof HTMLElement?k(d):k(u.button):k(u.button);m==null||m.focus()}};return L(X,u),he(P(()=>U(i.value,{0:C.Open,1:C.Closed}))),()=>{let{defaultOpen:d,...m}=e,g={open:i.value===0,close:u.close};return N({theirProps:m,ourProps:{},slot:g,slots:a,attrs:o,name:"Disclosure"})}}}),_e=E({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{attrs:a,slots:o,expose:i}){let t=z("DisclosureButton"),f=we(),u=P(()=>f===null?!1:f.value===t.panelId.value);M(()=>{u.value||e.id!==null&&(t.buttonId.value=e.id)}),q(()=>{u.value||(t.buttonId.value=null)});let d=h(null);i({el:d,$el:d}),u.value||T(()=>{t.button.value=d.value});let m=me(P(()=>({as:e.as,type:a.type})),d);function g(){var p;e.disabled||(u.value?(t.toggleDisclosure(),(p=k(t.button))==null||p.focus()):t.toggleDisclosure())}function v(p){var c;if(!e.disabled)if(u.value)switch(p.key){case O.Space:case O.Enter:p.preventDefault(),p.stopPropagation(),t.toggleDisclosure(),(c=k(t.button))==null||c.focus();break}else switch(p.key){case O.Space:case O.Enter:p.preventDefault(),p.stopPropagation(),t.toggleDisclosure();break}}function x(p){switch(p.key){case O.Space:p.preventDefault();break}}return()=>{var p;let c={open:t.disclosureState.value===0},{id:l,...s}=e,b=u.value?{ref:d,type:m.value,onClick:g,onKeydown:v}:{id:(p=t.buttonId.value)!=null?p:l,ref:d,type:m.value,"aria-expanded":t.disclosureState.value===0,"aria-controls":t.disclosureState.value===0||k(t.panel)?t.panelId.value:void 0,disabled:e.disabled?!0:void 0,onClick:g,onKeydown:v,onKeyup:x};return N({ourProps:b,theirProps:s,slot:c,attrs:a,slots:o,name:"DisclosureButton"})}}}),De=E({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:a,slots:o,expose:i}){let t=z("DisclosurePanel");M(()=>{e.id!==null&&(t.panelId.value=e.id)}),q(()=>{t.panelId.value=null}),i({el:t.panel,$el:t.panel}),L(ee,t.panelId);let f=ye(),u=P(()=>f!==null?(f.value&C.Open)===C.Open:t.disclosureState.value===0);return()=>{var d;let m={open:t.disclosureState.value===0,close:t.close},{id:g,...v}=e,x={id:(d=t.panelId.value)!=null?d:g,ref:t.panel};return N({ourProps:x,theirProps:v,slot:m,attrs:a,slots:o,features:B.RenderStrategy|B.Static,visible:u.value,name:"DisclosurePanel"})}}});const Oe={class:"space-y-8"},Ce={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},je={class:"flex items-center justify-between"},$e={class:"flex gap-3"},Pe={class:"mt-6 space-y-4"},Ue={class:"rounded-xl border border-slate-200 bg-white shadow-sm"},Ve={class:"text-sm font-semibold text-slate-900"},Ee={class:"text-xs text-slate-500"},Re={class:"space-y-3"},Ie={class:"flex items-center gap-2 text-xs font-medium text-slate-600"},Ae=["onUpdate:modelValue"],Be=["onUpdate:modelValue"],Me=["onUpdate:modelValue"],Te={key:0,class:"grid gap-3 md:grid-cols-2"},Le=["onUpdate:modelValue"],Ne=["onUpdate:modelValue"],ze={class:"md:col-span-2"},He=["onUpdate:modelValue"],Fe={key:1,class:"grid gap-3 md:grid-cols-2"},Ke=["onUpdate:modelValue"],Je=["onUpdate:modelValue"],We=["onUpdate:modelValue"],Ze=["onUpdate:modelValue"],qe={class:"flex justify-between"},Ge=["onClick"],Qe={key:0,class:"mt-4 text-sm text-slate-500"},Ye={key:1,class:"mt-2 text-sm font-medium text-rose-600"},et=E({__name:"SettingsAnonymizationRulesView",setup(e){const a=se(),o=ae([]),i=h(""),t=h(null);function f(c){return JSON.parse(JSON.stringify(c))}T(()=>{o.splice(0,o.length,...a.rules.map(c=>f(c)))});function u(c){const l=`${c}-${Date.now().toString(36)}`;let s=l,b=1;const r=new Set(o.map(j=>j.id));for(;r.has(s);)s=`${l}-${b}`,b+=1;return s}function d(){o.push({id:u("regex"),type:"regex",fields:["booking_text"],pattern:"",flags:"gi",replacement:"***",enabled:!0})}function m(){o.push({id:u("mask"),type:"mask",fields:["booking_text"],maskStrategy:"partialPercent",maskChar:"•",minLen:4,maskPercent:.5,enabled:!0})}function g(c){const l=o.findIndex(s=>s.id===c);l>=0&&o.splice(l,1)}async function v(){await a.save(o.map(c=>f(c))),i.value="Regeln gespeichert."}function x(){o.splice(0,o.length,...a.rules.map(c=>f(c))),i.value="Änderungen zurückgesetzt."}async function p(c){var b;const l=c.target,s=(b=l.files)==null?void 0:b[0];if(s)try{const r=JSON.parse(await s.text()),j=await a.importRules(r);j?(i.value="Regeln importiert.",o.splice(0,o.length,...j.map(te=>f(te)))):i.value="Import fehlgeschlagen."}catch(r){console.error("Import failed",r),i.value="Datei konnte nicht gelesen werden."}finally{l&&(l.value="")}}return(c,l)=>(w(),_("div",Oe,[n("section",Ce,[n("div",je,[l[1]||(l[1]=n("h2",{class:"text-lg font-semibold text-slate-900"},"Anonymisierungsregeln",-1)),n("div",$e,[n("input",{ref_key:"importInput",ref:t,type:"file",accept:"application/json",class:"hidden",onChange:p},null,544),n("button",{type:"button",class:"inline-flex items-center rounded-lg border border-indigo-200 px-3 py-2 text-xs font-semibold text-indigo-600 hover:bg-indigo-50",onClick:d}," Regex-Regel hinzufügen "),n("button",{type:"button",class:"inline-flex items-center rounded-lg border border-indigo-200 px-3 py-2 text-xs font-semibold text-indigo-600 hover:bg-indigo-50",onClick:m}," Maskierungsregel hinzufügen "),n("button",{type:"button",class:"inline-flex items-center rounded-lg border border-indigo-200 px-3 py-2 text-xs font-semibold text-indigo-600 hover:bg-indigo-50",onClick:l[0]||(l[0]=s=>{var b;return(b=t.value)==null?void 0:b.click()})}," Regeln importieren ")])]),l[15]||(l[15]=n("p",{class:"mt-2 text-sm text-slate-600"}," Regeln werden in der angegebenen Reihenfolge ausgeführt. Aktivieren Sie nur die benötigten Einträge. ",-1)),n("div",Pe,[(w(!0),_(Z,null,ie(o,s=>(w(),re(D(Se),{key:s.id},{default:R(({open:b})=>[n("div",Ue,[I(D(_e),{class:"flex w-full items-center justify-between px-4 py-3 text-left"},{default:R(()=>[n("div",null,[n("p",Ve,$(s.id),1),n("p",Ee,"Typ: "+$(s.type),1)]),I(D(pe),{class:ue(["h-4 w-4 transition-transform",b?"rotate-180":""])},null,8,["class"])]),_:2},1024),I(D(De),{class:"border-t border-slate-200 px-4 py-4 text-sm"},{default:R(()=>[n("div",Re,[n("label",Ie,[y(n("input",{"onUpdate:modelValue":r=>s.enabled=r,type:"checkbox",class:"h-4 w-4 rounded border-slate-300 text-indigo-600"},null,8,Ae),[[ce,s.enabled]]),l[2]||(l[2]=de(" Aktiv ",-1))]),n("div",null,[l[3]||(l[3]=n("label",{class:"block text-xs font-medium text-slate-600"},"Regel-ID",-1)),y(n("input",{"onUpdate:modelValue":r=>s.id=r,type:"text",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,Be),[[S,s.id]])]),n("div",null,[l[5]||(l[5]=n("label",{class:"block text-xs font-medium text-slate-600"},"Felder",-1)),y(n("select",{"onUpdate:modelValue":r=>s.fields=r,multiple:"",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},[...l[4]||(l[4]=[n("option",{value:"booking_text"},"Buchungstext",-1),n("option",{value:"booking_type"},"Buchungsart",-1)])],8,Me),[[F,s.fields]])]),s.type==="regex"?(w(),_("div",Te,[n("div",null,[l[6]||(l[6]=n("label",{class:"block text-xs font-medium text-slate-600"},"Pattern",-1)),y(n("input",{"onUpdate:modelValue":r=>s.pattern=r,type:"text",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,Le),[[S,s.pattern]])]),n("div",null,[l[7]||(l[7]=n("label",{class:"block text-xs font-medium text-slate-600"},"Flags",-1)),y(n("input",{"onUpdate:modelValue":r=>s.flags=r,type:"text",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,Ne),[[S,s.flags]])]),n("div",ze,[l[8]||(l[8]=n("label",{class:"block text-xs font-medium text-slate-600"},"Ersetzung",-1)),y(n("input",{"onUpdate:modelValue":r=>s.replacement=r,type:"text",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,He),[[S,s.replacement]])])])):(w(),_("div",Fe,[n("div",null,[l[10]||(l[10]=n("label",{class:"block text-xs font-medium text-slate-600"},"Maskierungsstrategie",-1)),y(n("select",{"onUpdate:modelValue":r=>s.maskStrategy=r,class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},[...l[9]||(l[9]=[n("option",{value:"full"},"Komplett",-1),n("option",{value:"keepFirstLast"},"Erstes/letztes Zeichen behalten",-1),n("option",{value:"partialPercent"},"Prozentual",-1)])],8,Ke),[[F,s.maskStrategy]])]),n("div",null,[l[11]||(l[11]=n("label",{class:"block text-xs font-medium text-slate-600"},"Maskierungszeichen",-1)),y(n("input",{"onUpdate:modelValue":r=>s.maskChar=r,type:"text",maxlength:"1",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,Je),[[S,s.maskChar]])]),n("div",null,[l[12]||(l[12]=n("label",{class:"block text-xs font-medium text-slate-600"},"Minimal-Länge",-1)),y(n("input",{"onUpdate:modelValue":r=>s.minLen=r,type:"number",min:"0",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,We),[[S,s.minLen,void 0,{number:!0}]])]),n("div",null,[l[13]||(l[13]=n("label",{class:"block text-xs font-medium text-slate-600"},"Maskierungsanteil",-1)),y(n("input",{"onUpdate:modelValue":r=>s.maskPercent=r,type:"number",min:"0",max:"1",step:"0.1",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,Ze),[[S,s.maskPercent,void 0,{number:!0}]])])])),n("div",qe,[n("button",{type:"button",class:"text-xs font-semibold text-rose-600 hover:text-rose-500",onClick:r=>g(s.id)}," Löschen ",8,Ge),l[14]||(l[14]=n("span",{class:"text-xs text-slate-500"},"ID muss eindeutig sein.",-1))])])]),_:2},1024)])]),_:2},1024))),128))]),n("div",{class:"mt-6 flex justify-end gap-3"},[n("button",{type:"button",class:"inline-flex items-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100",onClick:x}," Zurücksetzen "),n("button",{type:"button",class:"inline-flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-500",onClick:v}," Regeln speichern ")]),i.value?(w(),_("p",Qe,$(i.value),1)):H("",!0),D(a).error?(w(),_("p",Ye,$(D(a).error),1)):H("",!0)])]))}});export{et as default};
