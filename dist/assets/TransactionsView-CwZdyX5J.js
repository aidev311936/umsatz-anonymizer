import{_ as S}from"./TransactionImportsPanel.vue_vue_type_script_setup_true_lang-1ktQEVow.js";import{d as T,j as B,B as j,i as C,l as g,C as R,c as r,a as t,q as A,e as y,y as s,t as l,F as L,z as U,o as d}from"./index-Cwj_Fd2k.js";const V={class:"space-y-8"},D={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},M={class:"flex flex-wrap items-center gap-3"},K=["disabled"],N=["disabled"],E=["disabled"],F={key:0,class:"mt-4 rounded-lg bg-amber-50 px-4 py-3 text-sm text-amber-700"},O={class:"mt-6 overflow-x-auto"},W={class:"min-w-full divide-y divide-slate-200 text-left text-sm"},q={class:"divide-y divide-slate-100 bg-white text-slate-700"},H={class:"px-4 py-3 font-medium"},P={class:"px-4 py-3"},$={class:"px-4 py-3"},G={class:"px-4 py-3"},I={key:0},Y=T({__name:"TransactionsView",setup(J){const e=B(),h=j(),_=C(),p=g(()=>{const i=e.anonymized.length>0?e.anonymized:e.maskedTransactions.length>0?e.maskedTransactions:e.transactions;return R(i,_.resolvedSettings)}),o=g(()=>e.anonymized.length>0?e.anonymized:e.maskedTransactions.length>0?e.maskedTransactions:[]);function x(){e.anonymize(h.rules),e.setMaskedTransactions([...e.anonymized])}async function f(){o.value.length!==0&&await e.saveMasked(o.value)}async function k(){o.value.length!==0&&await e.persistMasked()}function v(){if(o.value.length===0)return;const i=["bank_name","booking_account","booking_date","booking_text","booking_type","booking_amount"],a=o.value.map(m=>i.map(z=>{const u=m[z];return typeof u=="string"?u.replace(/"/g,'""'):String(u??"")})),n=[i.join(";"),...a.map(m=>m.join(";"))].join(`
`),w=new Blob([n],{type:"text/csv;charset=utf-8"}),b=URL.createObjectURL(w),c=document.createElement("a");c.href=b,c.download="anonymisierte-umsaetze.csv",c.click(),URL.revokeObjectURL(b)}return(i,a)=>(d(),r("div",V,[t("section",D,[t("div",M,[t("button",{type:"button",class:"inline-flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-500",onClick:x}," Anonymisieren "),t("button",{type:"button",class:"inline-flex items-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100",disabled:s(e).anonymized.length===0,onClick:f}," Anonymisierte Kopie speichern ",8,K),t("button",{type:"button",class:"inline-flex items-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100",disabled:s(e).maskedTransactions.length===0&&s(e).anonymized.length===0,onClick:k}," Anonymisierte Kopie an Backend senden ",8,N),t("button",{type:"button",class:"inline-flex items-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100",disabled:o.value.length===0,onClick:v}," Anonymisierte UmsÃ¤tze herunterladen ",8,E)]),s(e).anonymizationWarnings.length?(d(),r("p",F,l(s(e).anonymizationWarnings.join(" ")),1)):y("",!0),t("div",O,[t("table",W,[a[1]||(a[1]=t("thead",{class:"bg-slate-50 text-xs font-semibold uppercase tracking-wide text-slate-500"},[t("tr",null,[t("th",{scope:"col",class:"px-4 py-3"},"Buchungstag"),t("th",{scope:"col",class:"px-4 py-3"},"Buchungstext"),t("th",{scope:"col",class:"px-4 py-3"},"Vorgang"),t("th",{scope:"col",class:"px-4 py-3"},"Betrag")])],-1)),t("tbody",q,[(d(!0),r(L,null,U(p.value,n=>(d(),r("tr",{key:n.booking_date+n.booking_text+n.booking_amount},[t("td",H,l(n.booking_date),1),t("td",P,l(n.booking_text),1),t("td",$,l(n.booking_type),1),t("td",G,l(n.booking_amount),1)]))),128)),p.value.length===0?(d(),r("tr",I,[...a[0]||(a[0]=[t("td",{colspan:"4",class:"px-4 py-6 text-center text-sm text-slate-500"},"Keine Transaktionen vorhanden.",-1)])])):y("",!0)])])])]),A(S,{history:s(e).history,onRefresh:s(e).refreshHistory},null,8,["history","onRefresh"])]))}});export{Y as default};
